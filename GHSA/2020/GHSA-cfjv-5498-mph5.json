{
	"schema_version": "1.6.0",
	"id": "GHSA-cfjv-5498-mph5",
	"modified": "2023-11-08T04:02:31.923390Z",
	"published": "2020-09-11T15:19:57Z",
	"aliases": [
		"CVE-2020-15169"
	],
	"summary": "XSS in Action View",
	"details": "There is a potential Cross-Site Scripting (XSS) vulnerability in Action View's translation helpers. Views that allow the user to control the default (not found) value of the `t` and `translate` helpers could be susceptible to XSS attacks.\n\n### Impact\n\nWhen an HTML-unsafe string is passed as the default for a missing translation key [named `html` or ending in `_html`](https://guides.rubyonrails.org/i18n.html#using-safe-html-translations), the default string is incorrectly marked as HTML-safe and not escaped. Vulnerable code may look like the following examples:\n\n```erb\n<%# The welcome_html translation is not defined for the current locale: %>\n<%= t(\"welcome_html\", default: untrusted_user_controlled_string) %>\n\n<%# Neither the title.html translation nor the missing.html translation is defined for the current locale: %>\n<%= t(\"title.html\", default: [:\"missing.html\", untrusted_user_controlled_string]) %>\n```\n\n### Patches\n\nPatched Rails versions, 6.0.3.3 and 5.2.4.4, are available from the normal locations.\n\nThe patches have also been applied to the `master`, `6-0-stable`, and `5-2-stable` branches on GitHub. If you track any of these branches, you should update to the latest.\n\nTo aid users who aren’t able to upgrade immediately, we’ve provided patches for the two supported release series. They are in git-am format and consist of a single changeset.\n\n* [5-2-translate-helper-xss.patch](https://gist.github.com/georgeclaghorn/a466e103922ee81f24c32c9034089442#file-5-2-translate-helper-xss-patch) — patch for the 5.2 release series\n* [6-0-translate-helper-xss.patch](https://gist.github.com/georgeclaghorn/a466e103922ee81f24c32c9034089442#file-6-0-translate-helper-xss-patch) — patch for the 6.0 release series\n\nPlease note that only the 5.2 and 6.0 release series are currently supported. Users of earlier, unsupported releases are advised to update as soon as possible, as we cannot provide security fixes for unsupported releases.\n\n### Workarounds\n\nImpacted users who can’t upgrade to a patched Rails version can avoid this issue by manually escaping default translations with the `html_escape` helper (aliased as `h`):\n\n```erb\n<%= t(\"welcome_html\", default: h(untrusted_user_controlled_string)) %>\n```",
	"severity": [
		{
			"type": "CVSS_V3",
			"score": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:L/I:L/A:N"
		}
	],
	"affected": [
		{
			"package": {
				"ecosystem": "RubyGems",
				"name": "actionview",
				"purl": "pkg:gem/actionview"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "0"
						},
						{
							"fixed": "5.2.4.4"
						}
					]
				}
			],
			"versions": [
				"4.1.0",
				"4.1.0.beta1",
				"4.1.0.beta2",
				"4.1.0.rc1",
				"4.1.0.rc2",
				"4.1.1",
				"4.1.10",
				"4.1.10.rc1",
				"4.1.10.rc2",
				"4.1.10.rc3",
				"4.1.10.rc4",
				"4.1.11",
				"4.1.12",
				"4.1.12.rc1",
				"4.1.13",
				"4.1.13.rc1",
				"4.1.14",
				"4.1.14.1",
				"4.1.14.2",
				"4.1.14.rc1",
				"4.1.14.rc2",
				"4.1.15",
				"4.1.15.rc1",
				"4.1.16",
				"4.1.16.rc1",
				"4.1.2",
				"4.1.2.rc1",
				"4.1.2.rc2",
				"4.1.2.rc3",
				"4.1.3",
				"4.1.4",
				"4.1.5",
				"4.1.6",
				"4.1.6.rc1",
				"4.1.6.rc2",
				"4.1.7",
				"4.1.7.1",
				"4.1.8",
				"4.1.9",
				"4.1.9.rc1",
				"4.2.0",
				"4.2.0.beta1",
				"4.2.0.beta2",
				"4.2.0.beta3",
				"4.2.0.beta4",
				"4.2.0.rc1",
				"4.2.0.rc2",
				"4.2.0.rc3",
				"4.2.1",
				"4.2.1.rc1",
				"4.2.1.rc2",
				"4.2.1.rc3",
				"4.2.1.rc4",
				"4.2.10",
				"4.2.10.rc1",
				"4.2.11",
				"4.2.11.1",
				"4.2.11.2",
				"4.2.11.3",
				"4.2.2",
				"4.2.3",
				"4.2.3.rc1",
				"4.2.4",
				"4.2.4.rc1",
				"4.2.5",
				"4.2.5.1",
				"4.2.5.2",
				"4.2.5.rc1",
				"4.2.5.rc2",
				"4.2.6",
				"4.2.6.rc1",
				"4.2.7",
				"4.2.7.1",
				"4.2.7.rc1",
				"4.2.8",
				"4.2.8.rc1",
				"4.2.9",
				"4.2.9.rc1",
				"4.2.9.rc2",
				"5.0.0",
				"5.0.0.1",
				"5.0.0.beta1",
				"5.0.0.beta1.1",
				"5.0.0.beta2",
				"5.0.0.beta3",
				"5.0.0.beta4",
				"5.0.0.racecar1",
				"5.0.0.rc1",
				"5.0.0.rc2",
				"5.0.1",
				"5.0.1.rc1",
				"5.0.1.rc2",
				"5.0.2",
				"5.0.2.rc1",
				"5.0.3",
				"5.0.4",
				"5.0.4.rc1",
				"5.0.5",
				"5.0.5.rc1",
				"5.0.5.rc2",
				"5.0.6",
				"5.0.6.rc1",
				"5.0.7",
				"5.0.7.1",
				"5.0.7.2",
				"5.1.0",
				"5.1.0.beta1",
				"5.1.0.rc1",
				"5.1.0.rc2",
				"5.1.1",
				"5.1.2",
				"5.1.2.rc1",
				"5.1.3",
				"5.1.3.rc1",
				"5.1.3.rc2",
				"5.1.3.rc3",
				"5.1.4",
				"5.1.4.rc1",
				"5.1.5",
				"5.1.5.rc1",
				"5.1.6",
				"5.1.6.1",
				"5.1.6.2",
				"5.1.7",
				"5.1.7.rc1",
				"5.2.0",
				"5.2.0.beta1",
				"5.2.0.beta2",
				"5.2.0.rc1",
				"5.2.0.rc2",
				"5.2.1",
				"5.2.1.1",
				"5.2.1.rc1",
				"5.2.2",
				"5.2.2.1",
				"5.2.2.rc1",
				"5.2.3",
				"5.2.3.rc1",
				"5.2.4",
				"5.2.4.1",
				"5.2.4.2",
				"5.2.4.3",
				"5.2.4.rc1"
			],
			"database_specific": {
				"last_known_affected_version_range": "<= 5.2.4.3",
				"source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2020/09/GHSA-cfjv-5498-mph5/GHSA-cfjv-5498-mph5.json"
			}
		},
		{
			"package": {
				"ecosystem": "RubyGems",
				"name": "actionview",
				"purl": "pkg:gem/actionview"
			},
			"ranges": [
				{
					"type": "ECOSYSTEM",
					"events": [
						{
							"introduced": "6.0.0.0"
						},
						{
							"fixed": "6.0.3.3"
						}
					]
				}
			],
			"versions": [
				"6.0.0",
				"6.0.1",
				"6.0.1.rc1",
				"6.0.2",
				"6.0.2.1",
				"6.0.2.2",
				"6.0.2.rc1",
				"6.0.2.rc2",
				"6.0.3",
				"6.0.3.1",
				"6.0.3.2",
				"6.0.3.rc1"
			],
			"database_specific": {
				"last_known_affected_version_range": "<= 6.0.3.2",
				"source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2020/09/GHSA-cfjv-5498-mph5/GHSA-cfjv-5498-mph5.json"
			}
		}
	],
	"references": [
		{
			"type": "WEB",
			"url": "https://github.com/rails/rails/security/advisories/GHSA-cfjv-5498-mph5"
		},
		{
			"type": "ADVISORY",
			"url": "https://nvd.nist.gov/vuln/detail/CVE-2020-15169"
		},
		{
			"type": "WEB",
			"url": "https://github.com/rails/rails/commit/e663f084460ea56c55c3dc76f78c7caeddeeb02e"
		},
		{
			"type": "PACKAGE",
			"url": "https://github.com/rails/rails"
		},
		{
			"type": "WEB",
			"url": "https://github.com/rubysec/ruby-advisory-db/blob/master/gems/actionview/CVE-2020-15169.yml"
		},
		{
			"type": "WEB",
			"url": "https://groups.google.com/g/rubyonrails-security/c/b-C9kSGXYrc"
		},
		{
			"type": "WEB",
			"url": "https://lists.debian.org/debian-lts-announce/2020/10/msg00015.html"
		},
		{
			"type": "WEB",
			"url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/XJ7NUWXAEVRQCROIIBV4C6WXO6IR3KSB/"
		},
		{
			"type": "WEB",
			"url": "https://www.debian.org/security/2020/dsa-4766"
		}
	],
	"database_specific": {
		"cwe_ids": [
			"CWE-79"
		],
		"github_reviewed": true,
		"github_reviewed_at": "2020-09-11T15:19:29Z",
		"nvd_published_at": null,
		"severity": "MODERATE"
	}
}
